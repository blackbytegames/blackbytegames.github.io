<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animecs Documentation</title>
    <style>
        /* [Previous CSS remains the same - keeping it brief for clarity] */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 14px; line-height: 1.7; color: #222; background: white; padding-top: 50px; }
        .unity-header { position: fixed; top: 0; left: 0; right: 0; height: 50px; background: #1a1a1a; z-index: 1000; display: flex; align-items: center; padding: 0 24px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .unity-logo { display: flex; align-items: center; margin-right: 32px; text-decoration: none; cursor: pointer; }
        .unity-logo img { height: 32px; width: auto; transition: opacity 0.2s; }
        .unity-nav { display: flex; gap: 24px; }
        .unity-nav a { color: rgba(255,255,255,0.85); text-decoration: none; font-size: 14px; padding: 15px 0; border-bottom: 2px solid transparent; transition: all 0.2s; cursor: pointer; }
        .unity-nav a:hover, .unity-nav a.active { color: white; border-bottom-color: white; }
        .unity-breadcrumb { position: fixed; top: 50px; left: 0; right: 0; height: 40px; background: #f0f0f0; border-bottom: 1px solid #d8d8d8; display: flex; align-items: center; padding: 0 24px; z-index: 999; font-size: 13px; }
        .unity-layout { display: grid; grid-template-columns: 280px 1fr 250px; position: fixed; top: 90px; left: 0; right: 0; bottom: 0; overflow: hidden; }
        .unity-sidebar-left { background: #f7f7f7; border-right: 1px solid #d8d8d8; overflow-y: auto; padding: 20px 0; }
        .unity-content { background: white; overflow-y: auto; padding: 40px 60px 100px 60px; }
        .unity-sidebar-right { background: #fafafa; border-left: 1px solid #e8e8e8; overflow-y: auto; padding: 20px; }
        .sidebar-nav ul { list-style: none; padding: 0; margin: 0; }
        .sidebar-nav a { display: block; padding: 6px 20px; color: #333; text-decoration: none; font-size: 13px; border-left: 3px solid transparent; transition: all 0.15s; }
        .sidebar-nav a:hover { background: rgba(0,0,0,0.03); color: #0066cc; }
        .sidebar-nav a.active { background: rgba(0,102,204,0.06); border-left-color: #0066cc; color: #0066cc; font-weight: 500; }
        .unity-content h1 { font-size: 36px; font-weight: 300; margin: 0 0 24px 0; }
        .unity-content h2 { font-size: 26px; font-weight: 400; margin: 48px 0 20px 0; }
        .unity-content pre { background: #f6f8fa; border: 1px solid #e1e4e8; border-radius: 3px; padding: 16px; margin: 20px 0; overflow-x: auto; }
        .unity-content code { background: #f0f0f0; padding: 2px 5px; border-radius: 3px; font-size: 13px; font-family: Monaco, monospace; }
        .unity-content pre code { background: transparent; padding: 0; }
    </style>
</head>
<body>
<div class="unity-header">
    <a href="#/" class="unity-logo">
        <img src="../assets/logo.png" alt="Blackbyte">
    </a>
    <nav class="unity-nav">
        <a href="#/manual" data-section="manual" class="nav-tab active">Manual</a>
        <a href="#/api" data-section="api" class="nav-tab">Scripting API</a>
        <a href="#/changelog" class="nav-tab">Changelog</a>
    </nav>
</div>

<div class="unity-breadcrumb">
    <a href="#/" id="breadcrumbSection">Manual</a>
    <span>/</span>
    <span id="breadcrumbCurrent">Animecs</span>
</div>

<div class="unity-layout">
    <div class="unity-sidebar-left">
        <nav class="sidebar-nav" id="leftNav"></nav>
    </div>

    <div class="unity-content" id="mainContent"></div>

    <div class="unity-sidebar-right">
        <div style="font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.8px; color: #999; margin-bottom: 12px;">IN THIS ARTICLE</div>
        <ul class="sidebar-toc" id="tocList"></ul>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
    let currentSection = 'manual';

    const navigation = {
        manual: [
            { title: 'About Animecs', url: 'manual/about.md' },
            { title: 'Getting Started', url: 'manual/getting-started.md' },
            { title: 'Architecture', url: 'manual/architecture.md' },
            {
                title: 'Tutorials',
                submenu: [
                    { title: 'Basic Setup', url: 'manual/tutorials/basic-setup.md' },
                    { title: 'State Machines', url: 'manual/tutorials/state-machines.md' },
                    { title: 'Blend Trees', url: 'manual/tutorials/blend-trees.md' },
                    { title: 'LOD System', url: 'manual/tutorials/lod-system.md' },
                    { title: 'Blend Shapes', url: 'manual/tutorials/blend-shapes.md' }
                ]
            },
            { title: 'Samples', url: 'manual/samples/README.md' },
            { title: 'Limitations', url: 'manual/limitations.md' }
        ],
        api: [
            { title: 'API Overview', url: 'api/README.md' },
            { title: 'AnimecsController', url: 'api/controller.md' },
            { title: 'Components', url: 'api/components.md' },
            { title: 'Systems', url: 'api/systems.md' },
            { title: 'Data Structures', url: 'api/data-structures.md' },
            { title: 'Bakers', url: 'api/baker.md' }
        ]
    };

    function buildNavigation(section = 'manual') {
        const nav = document.getElementById('leftNav');
        const items = navigation[section];
        let html = '<ul>';

        items.forEach((item, index) => {
            if (item.submenu) {
                html += `<li class="nav-parent">
                    <a href="#" onclick="event.preventDefault(); toggleSubmenu(${index});">
                        <span>${item.title}</span>
                        <span class="nav-parent-toggle" id="toggle-${index}">â–¼</span>
                    </a>
                    <ul id="submenu-${index}">`;
                item.submenu.forEach(sub => {
                    html += `<li><a href="#/${sub.url}" onclick="event.preventDefault(); loadContent('${sub.url}');">${sub.title}</a></li>`;
                });
                html += `</ul></li>`;
            } else {
                html += `<li><a href="#/${item.url}" onclick="event.preventDefault(); loadContent('${item.url}');">${item.title}</a></li>`;
            }
        });

        html += '</ul>';
        nav.innerHTML = html;
    }

    function toggleSubmenu(index) {
        const submenu = document.getElementById(`submenu-${index}`);
        const toggle = document.getElementById(`toggle-${index}`);
        submenu.classList.toggle('collapsed');
        toggle.classList.toggle('collapsed');
    }

    async function loadContent(file = 'manual/about.md') {
        try {
            const response = await fetch(file);
            if (!response.ok) throw new Error(`HTTP ${response.status}`);

            const text = await response.text();
            const html = marked.parse(text);
            document.getElementById('mainContent').innerHTML = html;

            const parts = file.split('/');
            const fileName = parts[parts.length - 1].replace('.md', '').replace(/-/g, ' ');
            const title = fileName.charAt(0).toUpperCase() + fileName.slice(1);
            document.getElementById('breadcrumbCurrent').textContent = title;

            generateTOC();
            highlightActiveNav(file);
            document.querySelector('.unity-content').scrollTop = 0;
        } catch (error) {
            document.getElementById('mainContent').innerHTML =
                `<h1>Error Loading Content</h1><p>Could not load <code>${file}</code></p><p>Error: ${error.message}</p>`;
        }
    }

    function generateTOC() {
        const content = document.getElementById('mainContent');
        const headings = content.querySelectorAll('h2, h3');
        const tocList = document.getElementById('tocList');

        if (headings.length === 0) {
            tocList.innerHTML = '<li style="color: #999; font-size: 12px;">No headings found</li>';
            return;
        }

        let html = '';
        headings.forEach(heading => {
            const id = heading.textContent.toLowerCase().replace(/[^a-z0-9]+/g, '-');
            heading.id = id;
            const tag = heading.tagName === 'H2' ? '' : 'style="padding-left: 12px; font-size: 12px;"';
            html += `<li ${tag}><a href="#${id}">${heading.textContent}</a></li>`;
        });

        tocList.innerHTML = html;
    }

    function highlightActiveNav(currentFile) {
        document.querySelectorAll('.sidebar-nav a').forEach(link => {
            link.classList.remove('active');
            const href = link.getAttribute('href');
            if (href && href.includes(currentFile)) {
                link.classList.add('active');
            }
        });
    }

    document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.addEventListener('click', (e) => {
            e.preventDefault();
            const section = tab.dataset.section;
            if (!section) return;

            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');

            document.getElementById('breadcrumbSection').textContent =
                section === 'manual' ? 'Manual' : 'Scripting API';

            currentSection = section;
            buildNavigation(section);

            const firstItem = navigation[section][0];
            loadContent(firstItem.url);
        });
    });

    window.addEventListener('hashchange', () => {
        const hash = window.location.hash.substring(2); // Remove #/
        if (hash && hash !== '') {
            loadContent(hash);
        }
    });

    // Initialize
    buildNavigation('manual');
    const initialHash = window.location.hash.substring(2);
    const initialFile = initialHash || 'manual/about.md';
    loadContent(initialFile);
</script>
</body>
</html>